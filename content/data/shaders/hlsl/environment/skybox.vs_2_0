#include "DATA/Shaders/HLSL/DX9HalfPixelAdjust.hls"

/////////////////////////////////////////////////////////////////////////////////////
///
/// Constants
///
/////////////////////////////////////////////////////////////////////////////////////

struct VERTEX
{
        float2 m_Position : X3D_VSIN_POSITION;
};

struct INTERPOLANTS
{
    float4 position    : POSITION;
    float3 cameraVec   : TEXCOORD0;
};

column_major float4x4 WorldViewProjInverse;
float3 CameraPos;

/////////////////////////////////////////////////////////////////////////////////////
///
/// Shader
///
/////////////////////////////////////////////////////////////////////////////////////
INTERPOLANTS main(VERTEX vertex)
{
    INTERPOLANTS interpolants;
    float4 pos = float4((vertex.m_Position * 2.0f) - 1.0f, 1.0f, 1.0f);
    float4 worldPos = mul(pos, WorldViewProjInverse);
    worldPos /= worldPos.w;

    interpolants.cameraVec = worldPos.xyz - CameraPos;

    DoDX9HalfPixelAdjust(pos);
    interpolants.position = pos;

    return interpolants;
}
